package modsim.simulator.control;

import java.util.Queue;

<<<<<<< HEAD
=======
import modsim.simulator.entities.Entity;
import modsim.simulator.entities.Server;
import modsim.simulator.entities.TipoServidor;
>>>>>>> f857b4125a6bcfd2b4e8ce9c0d701c61d4f46901
import modsim.simulator.model.Event;
import modsim.simulator.model.entity.Entity;
import modsim.simulator.model.server.Server;
import modsim.simulator.model.server.TipoServidor;

public class HandleFailureEnd implements Handler<Server> {

	@Override
	public Event<Server> handleEvent(Event<Server> event, int time)
			throws InterruptedException {
		Server server = event.getItem();
		server.setBroken(false);
		server.updateTempoFalha(time);
		Queue<Entity> fila = server.getFila();
		if (!fila.isEmpty()) {
			Entity first = fila.remove();
			server.ocuppyServer(first, time);
		}		
		if (server.getType() == TipoServidor.TIPO_1) {
			Simulator.getStats().setTimeOnFailureSvr1(server.getTempoFalha());
		}
		if (server.getType() == TipoServidor.TIPO_2) {
			Simulator.getStats().setTimeOnFailureSvr2(server.getTempoFalha());
		}		
		return EventFactory.newFailureStart(server, time);
	}

}
